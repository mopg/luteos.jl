function basisFuncTetLag( ::Type{Val{1}}, s::Array{Float64}, t::Array{Float64}, u::Array{Float64} )

  dim = 3
  nx  = length( s )

  # Linear

  nphi = 4
  phi  = Array{Float64}(nx, nphi)
  dphi = Array{Float64}(nx, nphi, dim)

  # value
  phi[:,1] = 1 - s - t - u # 1 @ node 0 (s = 0, t = 0, u = 0)
  phi[:,2] =     s         # 1 @ node 1 (s = 1, t = 0, u = 0)
  phi[:,3] =         t     # 1 @ node 2 (s = 0, t = 1, u = 0)
  phi[:,4] =             u # 1 @ node 3 (s = 0, t = 0, u = 1)

  # derivative in x
  dphi[:,1,1] = -1
  dphi[:,2,1] =  1
  dphi[:,3,1] =  0
  dphi[:,4,1] =  0

  # derivative in y
  dphi[:,1,2] = -1
  dphi[:,2,2] =  0
  dphi[:,3,2] =  1
  dphi[:,4,2] =  0

  # derivative in z
  dphi[:,1,3] = -1
  dphi[:,2,3] =  0
  dphi[:,3,3] =  0
  dphi[:,4,3] =  1

  return phi, dphi

end


function basisFuncTetLag( ::Type{Val{2}}, s::Array{Float64}, t::Array{Float64}, u::Array{Float64} )

  dim = 3
  nx  = length( s )

  # Quadratric
  nphi = 10
  phi  = Array{Float64}(nx, nphi)
  dphi = Array{Float64}(nx, nphi, dim)

  # value
  phi[:,1] =  s.*-3.0-t.*3.0-u.*3.0+s.*t.*4.0+s.*u.*4.0+t.*u.*4.0+(s.*s).*2.0+(t.*t).*2.0+(u.*u).*2.0+1.0
  phi[:,2] =  -s+(s.*s).*2.0
  phi[:,3] =  -t+(t.*t).*2.0
  phi[:,4] =  -u+(u.*u).*2.0
  phi[:,5] =  t.*u.*4.0
  phi[:,6] =  s.*u.*4.0
  phi[:,7] =  s.*t.*4.0
  phi[:,8] =  t.*4.0-s.*t.*4.0-t.*u.*4.0-(t.*t).*4.0
  phi[:,9] =  u.*4.0-s.*u.*4.0-t.*u.*4.0-(u.*u).*4.0
  phi[:,10] =  s.*4.0-s.*t.*4.0-s.*u.*4.0-(s.*s).*4.0

  # derivative in x
  dphi[:,1,1] =  s.*4.0+t.*4.0+u.*4.0-3.0
  dphi[:,2,1] =  s.*4.0-1.0
  dphi[:,3,1] =  0.0
  dphi[:,4,1] =  0.0
  dphi[:,5,1] =  0.0
  dphi[:,6,1] =  u.*4.0
  dphi[:,7,1] =  t.*4.0
  dphi[:,8,1] =  t.*-4.0
  dphi[:,9,1] =  u.*-4.0
  dphi[:,10,1] =  s.*-8.0-t.*4.0-u.*4.0+4.0

  # derivative in y
  dphi[:,1,2] =  s.*4.0+t.*4.0+u.*4.0-3.0
  dphi[:,2,2] =  0.0
  dphi[:,3,2] =  t.*4.0-1.0
  dphi[:,4,2] =  0.0
  dphi[:,5,2] =  u.*4.0
  dphi[:,6,2] =  0.0
  dphi[:,7,2] =  s.*4.0
  dphi[:,8,2] =  s.*-4.0-t.*8.0-u.*4.0+4.0
  dphi[:,9,2] =  u.*-4.0
  dphi[:,10,2] =  s.*-4.0

  # derivative in z
  dphi[:,1,3] =  s.*4.0+t.*4.0+u.*4.0-3.0
  dphi[:,2,3] =  0.0
  dphi[:,3,3] =  0.0
  dphi[:,4,3] =  u.*4.0-1.0
  dphi[:,5,3] =  t.*4.0
  dphi[:,6,3] =  s.*4.0
  dphi[:,7,3] =  0.0
  dphi[:,8,3] =  t.*-4.0
  dphi[:,9,3] =  s.*-4.0-t.*4.0-u.*8.0+4.0
  dphi[:,10,3] =  s.*-4.0

  return phi, dphi

end

function basisFuncTetLag( ::Type{Val{3}}, s::Array{Float64}, t::Array{Float64}, u::Array{Float64} )

  dim = 3
  nx  = length( s )

  # Cubic
  nphi = 20
  phi  = Array{Float64}(nx, nphi)
  dphi = Array{Float64}(nx, nphi, dim)

  # value
  phi[:,1] =  s.*(-1.1E1/2.0)-t.*(1.1E1/2.0)-u.*(1.1E1/2.0)+s.*t.*1.8E1+s.*u.*1.8E1+t.*u.*1.8E1-s.*(t.*t).*(2.7E1/2.0)-
             (s.*s).*t.*(2.7E1/2.0)-s.*(u.*u).*(2.7E1/2.0)-(s.*s).*u.*(2.7E1/2.0)-t.*(u.*u).*(2.7E1/2.0)-(t.*t).*u.*(2.7E1/2.0)+(s.*
             s).*9.0-(s.*s.*s).*(9.0/2.0)+(t.*t).*9.0-(t.*t.*t).*(9.0/2.0)+(u.*u).*9.0-(u.*u.*u).*(9.0/2.0)-s.*t.*u.*2.7E1+1.0
  phi[:,2] =  s-(s.*s).*(9.0/2.0)+(s.*s.*s).*(9.0/2.0)
  phi[:,3] =  t-(t.*t).*(9.0/2.0)+(t.*t.*t).*(9.0/2.0)
  phi[:,4] =  u-(u.*u).*(9.0/2.0)+(u.*u.*u).*(9.0/2.0)
  phi[:,5] =  t.*u.*(-9.0/2.0)+(t.*t).*u.*(2.7E1/2.0)
  phi[:,6] =  t.*u.*(-9.0/2.0)+t.*(u.*u).*(2.7E1/2.0)
  phi[:,7] =  s.*u.*(-9.0/2.0)+s.*(u.*u).*(2.7E1/2.0)
  phi[:,8] =  s.*u.*(-9.0/2.0)+(s.*s).*u.*(2.7E1/2.0)
  phi[:,9] =  s.*t.*(-9.0/2.0)+(s.*s).*t.*(2.7E1/2.0)
  phi[:,10] =  s.*t.*(-9.0/2.0)+s.*(t.*t).*(2.7E1/2.0)
  phi[:,11] =  t.*(-9.0/2.0)+s.*t.*(9.0/2.0)+t.*u.*(9.0/2.0)-s.*(t.*t).*(2.7E1/2.0)-(t.*t).*u.*(2.7E1/2.0)+(t.*t).*1.8E1-
             (t.*t.*t).*(2.7E1/2.0)
  phi[:,12] =  t.*9.0-s.*t.*(4.5E1/2.0)-t.*u.*(4.5E1/2.0)+s.*(t.*t).*2.7E1+(s.*s).*t.*(2.7E1/2.0)+t.*(u.*u).*(2.7E1/2.0)+
             (t.*t).*u.*2.7E1-(t.*t).*(4.5E1/2.0)+(t.*t.*t).*(2.7E1/2.0)+s.*t.*u.*2.7E1
  phi[:,13] =  u.*9.0-s.*u.*(4.5E1/2.0)-t.*u.*(4.5E1/2.0)+s.*(u.*u).*2.7E1+(s.*s).*u.*(2.7E1/2.0)+t.*(u.*u).*2.7E1+(t.*t).*
             u.*(2.7E1/2.0)-(u.*u).*(4.5E1/2.0)+(u.*u.*u).*(2.7E1/2.0)+s.*t.*u.*2.7E1
  phi[:,14] =  u.*(-9.0/2.0)+s.*u.*(9.0/2.0)+t.*u.*(9.0/2.0)-s.*(u.*u).*(2.7E1/2.0)-t.*(u.*u).*(2.7E1/2.0)+(u.*u).*1.8E1-
             (u.*u.*u).*(2.7E1/2.0)
  phi[:,15] =  s.*9.0-s.*t.*(4.5E1/2.0)-s.*u.*(4.5E1/2.0)+s.*(t.*t).*(2.7E1/2.0)+(s.*s).*t.*2.7E1+s.*(u.*u).*(2.7E1/2.0)+
             (s.*s).*u.*2.7E1-(s.*s).*(4.5E1/2.0)+(s.*s.*s).*(2.7E1/2.0)+s.*t.*u.*2.7E1
  phi[:,16] =  s.*(-9.0/2.0)+s.*t.*(9.0/2.0)+s.*u.*(9.0/2.0)-(s.*s).*t.*(2.7E1/2.0)-(s.*s).*u.*(2.7E1/2.0)+(s.*s).*1.8E1-
             (s.*s.*s).*(2.7E1/2.0)
  phi[:,17] =  s.*t.*u.*2.7E1
  phi[:,18] =  t.*u.*2.7E1-t.*(u.*u).*2.7E1-(t.*t).*u.*2.7E1-s.*t.*u.*2.7E1
  phi[:,19] =  s.*u.*2.7E1-s.*(u.*u).*2.7E1-(s.*s).*u.*2.7E1-s.*t.*u.*2.7E1
  phi[:,20] =  s.*t.*2.7E1-s.*(t.*t).*2.7E1-(s.*s).*t.*2.7E1-s.*t.*u.*2.7E1

  # derivative in x
  dphi[:,1,1] =  s.*1.8E1+t.*1.8E1+u.*1.8E1-s.*t.*2.7E1-s.*u.*2.7E1-t.*u.*2.7E1-(s.*s).*(2.7E1/2.0)-(t.*t).*(2.7E1/2.0)-
             (u.*u).*(2.7E1/2.0)-1.1E1/2.0
  dphi[:,2,1] =  s.*-9.0+(s.*s).*(2.7E1/2.0)+1.0
  dphi[:,3,1] =  0.0
  dphi[:,4,1] =  0.0
  dphi[:,5,1] =  0.0
  dphi[:,6,1] =  0.0
  dphi[:,7,1] =  u.*(-9.0/2.0)+(u.*u).*(2.7E1/2.0)
  dphi[:,8,1] =  u.*(-9.0/2.0)+s.*u.*2.7E1
  dphi[:,9,1] =  t.*(-9.0/2.0)+s.*t.*2.7E1
  dphi[:,10,1] =  t.*(-9.0/2.0)+(t.*t).*(2.7E1/2.0)
  dphi[:,11,1] =  t.*(9.0/2.0)-(t.*t).*(2.7E1/2.0)
  dphi[:,12,1] =  t.*(-4.5E1/2.0)+s.*t.*2.7E1+t.*u.*2.7E1+(t.*t).*2.7E1
  dphi[:,13,1] =  u.*(-4.5E1/2.0)+s.*u.*2.7E1+t.*u.*2.7E1+(u.*u).*2.7E1
  dphi[:,14,1] =  u.*(9.0/2.0)-(u.*u).*(2.7E1/2.0)
  dphi[:,15,1] =  s.*-4.5E1-t.*(4.5E1/2.0)-u.*(4.5E1/2.0)+s.*t.*5.4E1+s.*u.*5.4E1+t.*u.*2.7E1+(s.*s).*(8.1E1/2.0)+(t.*t).*
             (2.7E1/2.0)+(u.*u).*(2.7E1/2.0)+9.0
  dphi[:,16,1] =  s.*3.6E1+t.*(9.0/2.0)+u.*(9.0/2.0)-s.*t.*2.7E1-s.*u.*2.7E1-(s.*s).*(8.1E1/2.0)-9.0/2.0
  dphi[:,17,1] =  t.*u.*2.7E1
  dphi[:,18,1] =  t.*u.*-2.7E1
  dphi[:,19,1] =  u.*2.7E1-s.*u.*5.4E1-t.*u.*2.7E1-(u.*u).*2.7E1
  dphi[:,20,1] =  t.*2.7E1-s.*t.*5.4E1-t.*u.*2.7E1-(t.*t).*2.7E1

  # derivative in y
  dphi[:,1,2] =  s.*1.8E1+t.*1.8E1+u.*1.8E1-s.*t.*2.7E1-s.*u.*2.7E1-t.*u.*2.7E1-(s.*s).*(2.7E1/2.0)-(t.*t).*(2.7E1/2.0)-
             (u.*u).*(2.7E1/2.0)-1.1E1/2.0
  dphi[:,2,2] =  0.0
  dphi[:,3,2] =  t.*-9.0+(t.*t).*(2.7E1/2.0)+1.0
  dphi[:,4,2] =  0.0
  dphi[:,5,2] =  u.*(-9.0/2.0)+t.*u.*2.7E1
  dphi[:,6,2] =  u.*(-9.0/2.0)+(u.*u).*(2.7E1/2.0)
  dphi[:,7,2] =  0.0
  dphi[:,8,2] =  0.0
  dphi[:,9,2] =  s.*(-9.0/2.0)+(s.*s).*(2.7E1/2.0)
  dphi[:,10,2] =  s.*(-9.0/2.0)+s.*t.*2.7E1
  dphi[:,11,2] =  s.*(9.0/2.0)+t.*3.6E1+u.*(9.0/2.0)-s.*t.*2.7E1-t.*u.*2.7E1-(t.*t).*(8.1E1/2.0)-9.0/2.0
  dphi[:,12,2] =  s.*(-4.5E1/2.0)-t.*4.5E1-u.*(4.5E1/2.0)+s.*t.*5.4E1+s.*u.*2.7E1+t.*u.*5.4E1+(s.*s).*(2.7E1/2.0)+(t.*t).*
             (8.1E1/2.0)+(u.*u).*(2.7E1/2.0)+9.0
  dphi[:,13,2] =  u.*(-4.5E1/2.0)+s.*u.*2.7E1+t.*u.*2.7E1+(u.*u).*2.7E1
  dphi[:,14,2] =  u.*(9.0/2.0)-(u.*u).*(2.7E1/2.0)
  dphi[:,15,2] =  s.*(-4.5E1/2.0)+s.*t.*2.7E1+s.*u.*2.7E1+(s.*s).*2.7E1
  dphi[:,16,2] =  s.*(9.0/2.0)-(s.*s).*(2.7E1/2.0)
  dphi[:,17,2] =  s.*u.*2.7E1
  dphi[:,18,2] =  u.*2.7E1-s.*u.*2.7E1-t.*u.*5.4E1-(u.*u).*2.7E1
  dphi[:,19,2] =  s.*u.*-2.7E1
  dphi[:,20,2] =  s.*2.7E1-s.*t.*5.4E1-s.*u.*2.7E1-(s.*s).*2.7E1

  # derivative in z
  dphi[:,1,3] =  s.*1.8E1+t.*1.8E1+u.*1.8E1-s.*t.*2.7E1-s.*u.*2.7E1-t.*u.*2.7E1-(s.*s).*(2.7E1/2.0)-(t.*t).*(2.7E1/2.0)-
             (u.*u).*(2.7E1/2.0)-1.1E1/2.0
  dphi[:,2,3] =  0.0
  dphi[:,3,3] =  0.0
  dphi[:,4,3] =  u.*-9.0+(u.*u).*(2.7E1/2.0)+1.0
  dphi[:,5,3] =  t.*(-9.0/2.0)+(t.*t).*(2.7E1/2.0)
  dphi[:,6,3] =  t.*(-9.0/2.0)+t.*u.*2.7E1
  dphi[:,7,3] =  s.*(-9.0/2.0)+s.*u.*2.7E1
  dphi[:,8,3] =  s.*(-9.0/2.0)+(s.*s).*(2.7E1/2.0)
  dphi[:,9,3] =  0.0
  dphi[:,10,3] =  0.0
  dphi[:,11,3] =  t.*(9.0/2.0)-(t.*t).*(2.7E1/2.0)
  dphi[:,12,3] =  t.*(-4.5E1/2.0)+s.*t.*2.7E1+t.*u.*2.7E1+(t.*t).*2.7E1
  dphi[:,13,3] =  s.*(-4.5E1/2.0)-t.*(4.5E1/2.0)-u.*4.5E1+s.*t.*2.7E1+s.*u.*5.4E1+t.*u.*5.4E1+(s.*s).*(2.7E1/2.0)+(t.*t).*
             (2.7E1/2.0)+(u.*u).*(8.1E1/2.0)+9.0
  dphi[:,14,3] =  s.*(9.0/2.0)+t.*(9.0/2.0)+u.*3.6E1-s.*u.*2.7E1-t.*u.*2.7E1-(u.*u).*(8.1E1/2.0)-9.0/2.0
  dphi[:,15,3] =  s.*(-4.5E1/2.0)+s.*t.*2.7E1+s.*u.*2.7E1+(s.*s).*2.7E1
  dphi[:,16,3] =  s.*(9.0/2.0)-(s.*s).*(2.7E1/2.0)
  dphi[:,17,3] =  s.*t.*2.7E1
  dphi[:,18,3] =  t.*2.7E1-s.*t.*2.7E1-t.*u.*5.4E1-(t.*t).*2.7E1
  dphi[:,19,3] =  s.*2.7E1-s.*t.*2.7E1-s.*u.*5.4E1-(s.*s).*2.7E1
  dphi[:,20,3] =  s.*t.*-2.7E1

  return phi, dphi

end
