# ---------------------------------------------------------------------------- #
#
#   basisFuncTriangleLag.jl
#
#   Get Lagrangian basis functions for Triangle
#
#   λυτέος
#   Fall 2017
#
#   Max Opgenoord
#
# ---------------------------------------------------------------------------- #

function basisFuncTriangleLag( P::P1, s::Vector{Float64}, t::Vector{Float64} )

  dim = 2
  nx  = length( s )

  # Linear

  nphi = 3
  phi  = Array{Float64}(nphi, nx)
  dphi = Array{Float64}(nphi, nx, dim)

  # value
  phi[1,:] = -s -t + 1.0
  phi[2,:] =  s
  phi[3,:] =  t

  # derivative in x
  dphi[1,:,1] =  -1.0
  dphi[2,:,1] =   1.0
  dphi[3,:,1] =   0.0

  # derivative in y
  dphi[1,:,2] =  -1.0
  dphi[2,:,2] =   0.0
  dphi[3,:,2] =   1.0

  return phi, dphi

end

function basisFuncTriangleLag( P::P2, s::Vector{Float64}, t::Vector{Float64} )

  dim = 2
  nx  = length( s )

  # Quadratric

  nphi = 6
  phi  = Array{Float64}(nx, nphi)
  dphi = Array{Float64}(nx, nphi, dim)

  # value
  phi[1,:] = s.*-3.0-t.*3.0+s.*t.*4.0+(s.*s).*2.0+(t.*t).*2.0+1.0
  phi[2,:] = -s+(s.*s).*2.0
  phi[3,:] = -t+(t.*t).*2.0
  phi[4,:] = s.*t.*4.0
  phi[5,:] = t.*(s+t-1.0).*-4.0
  phi[6,:] = -s.*(s.*4.0+t.*4.0-4.0)

  # derivative in x
  dphi[1,:,1] = s.*4.0+t.*4.0-3.0
  dphi[2,:,1] = s.*4.0-1.0
  dphi[3,:,1] = 0.0
  dphi[4,:,1] = t.*4.0
  dphi[5,:,1] = t.*-4.0
  dphi[6,:,1] = s.*-8.0-t.*4.0+4.0

  # derivative in y
  dphi[1,:,2] = s.*4.0+t.*4.0-3.0
  dphi[2,:,2] = 0.0
  dphi[3,:,2] = t.*4.0-1.0
  dphi[4,:,2] = s.*4.0
  dphi[5,:,2] = s.*-4.0-t.*8.0+4.0
  dphi[6,:,2] = s.*-4.0

  return phi, dphi

end

function basisFuncTriangleLag( P::P3, s::Vector{Float64}, t::Vector{Float64} )

  dim = 2
  nx  = length( s )

  nphi = 10
  phi  = Array{Float64}(nphi, nx)
  dphi = Array{Float64}(nphi, nx, dim)

  # value
  phi[1,:] = s.*(-1.1E1/2.0)-t.*(1.1E1/2.0)+s.*t.*1.8E1-s.*(t.*t).*(2.7E1/2.0)-(s.*s).*t.*(2.7E1/2.0)+(s.*s).*9.0-
              (s.*s.*s).*(9.0/2.0)+(t.*t).*9.0-(t.*t.*t).*(9.0/2.0)+1.0
  phi[2,:] = s-(s.*s).*(9.0/2.0)+(s.*s.*s).*(9.0/2.0)
  phi[3,:] = t-(t.*t).*(9.0/2.0)+(t.*t.*t).*(9.0/2.0)
  phi[4,:] = s.*t.*(-9.0/2.0)+(s.*s).*t.*(2.7E1/2.0)

  phi[5,:] =  s.*t.*(-9.0/2.0)+s.*(t.*t).*(2.7E1/2.0)

  phi[6,:] =  t.*(-9.0/2.0)+s.*t.*(9.0/2.0)-s.*(t.*t).*(2.7E1/2.0)+(t.*t).*1.8E1-(t.*t.*t).*(2.7E1/2.0)

  phi[7,:] =  t.*9.0-s.*t.*(4.5E1/2.0)+s.*(t.*t).*2.7E1+(s.*s).*t.*(2.7E1/2.0)-(t.*t).*(4.5E1/2.0)+(t.*t.*t).*(2.7E1/2.0)

  phi[8,:] =  s.*9.0-s.*t.*(4.5E1/2.0)+s.*(t.*t).*(2.7E1/2.0)+(s.*s).*t.*2.7E1-(s.*s).*(4.5E1/2.0)+(s.*s.*s).*(2.7E1/2.0)

  phi[9,:] =  s.*(-9.0/2.0)+s.*t.*(9.0/2.0)-(s.*s).*t.*(2.7E1/2.0)+(s.*s).*1.8E1-(s.*s.*s).*(2.7E1/2.0)

  phi[10,:] =  s.*t.*2.7E1-s.*(t.*t).*2.7E1-(s.*s).*t.*2.7E1

  # derivative in x
  dphi[1,:,1] =  s.*1.8E1+t.*1.8E1-s.*t.*2.7E1-(s.*s).*(2.7E1/2.0)-(t.*t).*(2.7E1/2.0)-1.1E1/2.0

  dphi[2,:,1] =  s.*-9.0+(s.*s).*(2.7E1/2.0)+1.0

  dphi[3,:,1] =  0.0

  dphi[4,:,1] =  t.*(-9.0/2.0)+s.*t.*2.7E1

  dphi[5,:,1] =  t.*(-9.0/2.0)+(t.*t).*(2.7E1/2.0)

  dphi[6,:,1] =  t.*(9.0/2.0)-(t.*t).*(2.7E1/2.0)

  dphi[7,:,1] =  t.*(-4.5E1/2.0)+s.*t.*2.7E1+(t.*t).*2.7E1

  dphi[8,:,1] =  s.*-4.5E1-t.*(4.5E1/2.0)+s.*t.*5.4E1+(s.*s).*(8.1E1/2.0)+(t.*t).*(2.7E1/2.0)+9.0

  dphi[9,:,1] =  s.*3.6E1+t.*(9.0/2.0)-s.*t.*2.7E1-(s.*s).*(8.1E1/2.0)-9.0/2.0

  dphi[10,:,1] =  t.*2.7E1-s.*t.*5.4E1-(t.*t).*2.7E1

  # dphi/dy
  dphi[1,:,2] =  s.*1.8E1+t.*1.8E1-s.*t.*2.7E1-(s.*s).*(2.7E1/2.0)-(t.*t).*(2.7E1/2.0)-1.1E1/2.0
  dphi[2,:,2] =  0.0
  dphi[3,:,2] =  t.*-9.0+(t.*t).*(2.7E1/2.0)+1.0
  dphi[4,:,2] =  s.*(-9.0/2.0)+(s.*s).*(2.7E1/2.0)
  dphi[5,:,2] =  s.*(-9.0/2.0)+s.*t.*2.7E1
  dphi[6,:,2] =  s.*(9.0/2.0)+t.*3.6E1-s.*t.*2.7E1-(t.*t).*(8.1E1/2.0)-9.0/2.0
  dphi[7,:,2] =  s.*(-4.5E1/2.0)-t.*4.5E1+s.*t.*5.4E1+(s.*s).*(2.7E1/2.0)+(t.*t).*(8.1E1/2.0)+9.0
  dphi[8,:,2] =  s.*(-4.5E1/2.0)+s.*t.*2.7E1+(s.*s).*2.7E1
  dphi[9,:,2] =  s.*(9.0/2.0)-(s.*s).*(2.7E1/2.0)
  dphi[10,:,2] =  s.*2.7E1-s.*t.*5.4E1-(s.*s).*2.7E1

  return phi, dphi

end

function basisFuncTriangleLag( P::P4, s::Vector{Float64}, t::Vector{Float64} )

  dim = 2
  nx  = length( s )

  nphi = 15
  phi  = Array{Float64}(nphi, nx)
  dphi = Array{Float64}(nphi, nx, dim)

  # value
  phi[1,:] =  (s.*s).*(t.*t).*6.4E1-(1./3).*s.*2.5E1-(1./3).*t.*2.5E1+(1./3).*(s.*s).*7.0E1-(1./3).*(s.*s.*s).*8.0E1+
      (1./3).*(s.*s.*s.*s).*3.2E1+(1./3).*(t.*t).*7.0E1-(1./3).*(t.*t.*t).*8.0E1+(1./3).*(t.*t.*t.*t).*3.2E1-s.*(t.*t).*
      8.0E1-(s.*s).*t.*8.0E1+(1./3).*s.*t.*1.4E2+(1./3).*s.*(t.*t.*t).*1.28E2+(1./3).*(s.*s.*s).*t.*1.28E2+1.0

  phi[2,:] =  -s+(1./3).*(s.*s).*2.2E1+(1./3).*(s.*s.*s.*s).*3.2E1-(s.*s.*s).*1.6E1

  phi[3,:] =  -t+(1./3).*(t.*t).*2.2E1+(1./3).*(t.*t.*t.*t).*3.2E1-(t.*t.*t).*1.6E1

  phi[4,:] =  (s.*s).*t.*-3.2E1+(1./3).*s.*t.*1.6E1+(1./3).*(s.*s.*s).*t.*1.28E2

  phi[5,:] =  (s.*s).*(t.*t).*6.4E1+s.*t.*4.0-s.*(t.*t).*1.6E1-(s.*s).*t.*1.6E1

  phi[6,:] =  s.*(t.*t).*-3.2E1+(1./3).*s.*t.*1.6E1+(1./3).*s.*(t.*t.*t).*1.28E2

  phi[7,:] =  (1./3).*t.*1.6E1-(1./3).*(t.*t).*1.12E2+(1./3).*(t.*t.*t).*2.24E2-(1./3).*(t.*t.*t.*t).*1.28E2+s.*
      (t.*t).*3.2E1-(1./3).*s.*t.*1.6E1-(1./3).*s.*(t.*t.*t).*1.28E2

  phi[8,:] =  t.*-1.2E1+(s.*s).*(t.*t).*6.4E1+s.*t.*2.8E1-s.*(t.*t).*1.44E2-(s.*s).*t.*1.6E1+s.*(t.*t.*t).*1.28E2+(t.*t).*7.6E1-
      (t.*t.*t).*1.28E2+(t.*t.*t.*t).*6.4E1

  phi[9,:] =  t.*1.6E1-(s.*s).*(t.*t).*1.28E2-(1./3).*(t.*t).*2.08E2-(1./3).*(t.*t.*t.*t).*1.28E2+s.*(t.*t).*1.92E2+(s.*
      s).*t.*9.6E1-s.*(t.*t.*t).*1.28E2+(t.*t.*t).*9.6E1-(1./3).*s.*t.*2.08E2-(1./3).*(s.*s.*s).*t.*1.28E2

  phi[10,:] =  s.*1.6E1-(s.*s).*(t.*t).*1.28E2-(1./3).*(s.*s).*2.08E2-(1./3).*(s.*s.*s.*s).*1.28E2+s.*(t.*t).*9.6E1+(s.*
      s).*t.*1.92E2-(s.*s.*s).*t.*1.28E2+(s.*s.*s).*9.6E1-(1./3).*s.*t.*2.08E2-(1./3).*s.*(t.*t.*t).*1.28E2

  phi[11,:] =  s.*-1.2E1+(s.*s).*(t.*t).*6.4E1+s.*t.*2.8E1-s.*(t.*t).*1.6E1-(s.*s).*t.*1.44E2+(s.*s.*s).*t.*1.28E2+(s.*s).*7.6E1-
      (s.*s.*s).*1.28E2+(s.*s.*s.*s).*6.4E1

  phi[12,:] =  (1./3).*s.*1.6E1-(1./3).*(s.*s).*1.12E2+(1./3).*(s.*s.*s).*2.24E2-(1./3).*(s.*s.*s.*s).*1.28E2+(s.*
      s).*t.*3.2E1-(1./3).*s.*t.*1.6E1-(1./3).*(s.*s.*s).*t.*1.28E2

  phi[13,:] =  (s.*s).*(t.*t).*2.56E2+s.*t.*9.6E1-s.*(t.*t).*2.24E2-(s.*s).*t.*2.24E2+s.*(t.*t.*t).*1.28E2+(s.*s.*s).*t.*1.28E2

  phi[14,:] =  (s.*s).*(t.*t).*-1.28E2-s.*t.*3.2E1+s.*(t.*t).*3.2E1+(s.*s).*t.*1.6E2-(s.*s.*s).*t.*1.28E2

  phi[15,:] =  (s.*s).*(t.*t).*-1.28E2-s.*t.*3.2E1+s.*(t.*t).*1.6E2+(s.*s).*t.*3.2E1-s.*(t.*t.*t).*1.28E2

  # derivative in x
  dphi[1,:,1] =  (1./3).*-2.5E1+(1./3).*s.*1.4E2+(1./3).*t.*1.4E2-s.*t.*1.6E2-(1./3).*(s.*s).*2.4E2+(1./3).*
      (s.*s.*s).*1.28E2+(1./3).*(t.*t.*t).*1.28E2+s.*(t.*t).*1.28E2-(t.*t).*8.0E1+(1./3).*(s.*s).*t.*3.84E2

  dphi[2,:,1] =  (1./3).*s.*4.4E1+(1./3).*(s.*s.*s).*1.28E2-(s.*s).*4.8E1-1.0

  dphi[3,:,1] =  0.0

  dphi[4,:,1] =  (1./3).*t.*1.6E1-s.*t.*6.4E1+(1./3).*(s.*s).*t.*3.84E2

  dphi[5,:,1] =  t.*4.0-s.*t.*3.2E1+s.*(t.*t).*1.28E2-(t.*t).*1.6E1

  dphi[6,:,1] =  (1./3).*t.*1.6E1+(1./3).*(t.*t.*t).*1.28E2-(t.*t).*3.2E1

  dphi[7,:,1] =  (1./3).*t.*-1.6E1-(1./3).*(t.*t.*t).*1.28E2+(t.*t).*3.2E1

  dphi[8,:,1] =  t.*2.8E1-s.*t.*3.2E1+s.*(t.*t).*1.28E2-(t.*t).*1.44E2+(t.*t.*t).*1.28E2

  dphi[9,:,1] =  (1./3).*t.*-2.08E2+s.*t.*1.92E2-s.*(t.*t).*2.56E2+(t.*t).*1.92E2-(t.*t.*t).*1.28E2-(1./3).*(s.*s).*t.*
      3.84E2

  dphi[10,:,1] =  (1./3).*s.*-4.16E2-(1./3).*t.*2.08E2+s.*t.*3.84E2-(1./3).*(s.*s.*s).*5.12E2-(1./3).*(t.*t.*t).*1.28E2-
      s.*(t.*t).*2.56E2-(s.*s).*t.*3.84E2+(s.*s).*2.88E2+(t.*t).*9.6E1+1.6E1

  dphi[11,:,1] =  s.*1.52E2+t.*2.8E1-s.*t.*2.88E2+s.*(t.*t).*1.28E2+(s.*s).*t.*3.84E2-(s.*s).*3.84E2+(s.*s.*s).*2.56E2-(t.*
      t).*1.6E1-1.2E1

  dphi[12,:,1] =  (1./3).*1.6E1-(1./3).*s.*2.24E2-(1./3).*t.*1.6E1+s.*t.*6.4E1+(1./3).*(s.*s).*6.72E2-(1./3).*
      (s.*s.*s).*5.12E2-(1./3).*(s.*s).*t.*3.84E2

  dphi[13,:,1] =  t.*9.6E1-s.*t.*4.48E2+s.*(t.*t).*5.12E2+(s.*s).*t.*3.84E2-(t.*t).*2.24E2+(t.*t.*t).*1.28E2

  dphi[14,:,1] =  t.*-3.2E1+s.*t.*3.2E2-s.*(t.*t).*2.56E2-(s.*s).*t.*3.84E2+(t.*t).*3.2E1

  dphi[15,:,1] =  t.*-3.2E1+s.*t.*6.4E1-s.*(t.*t).*2.56E2+(t.*t).*1.6E2-(t.*t.*t).*1.28E2

  # derivative in y
  dphi[1,:,2] =  (1./3).*-2.5E1+(1./3).*s.*1.4E2+(1./3).*t.*1.4E2-s.*t.*1.6E2+(1./3).*(s.*s.*s).*1.28E2-(1./3).*
      (t.*t).*2.4E2+(1./3).*(t.*t.*t).*1.28E2+(s.*s).*t.*1.28E2-(s.*s).*8.0E1+(1./3).*s.*(t.*t).*3.84E2

  dphi[2,:,2] =  0.0

  dphi[3,:,2] =  (1./3).*t.*4.4E1+(1./3).*(t.*t.*t).*1.28E2-(t.*t).*4.8E1-1.0

  dphi[4,:,2] =  (1./3).*s.*1.6E1+(1./3).*(s.*s.*s).*1.28E2-(s.*s).*3.2E1

  dphi[5,:,2] =  s.*4.0-s.*t.*3.2E1+(s.*s).*t.*1.28E2-(s.*s).*1.6E1

  dphi[6,:,2] =  (1./3).*s.*1.6E1-s.*t.*6.4E1+(1./3).*s.*(t.*t).*3.84E2

  dphi[7,:,2] =  (1./3).*1.6E1-(1./3).*s.*1.6E1-(1./3).*t.*2.24E2+s.*t.*6.4E1+(1./3).*(t.*t).*6.72E2-(1./3).*
      (t.*t.*t).*5.12E2-(1./3).*s.*(t.*t).*3.84E2

  dphi[8,:,2] =  s.*2.8E1+t.*1.52E2-s.*t.*2.88E2+s.*(t.*t).*3.84E2+(s.*s).*t.*1.28E2-(s.*s).*1.6E1-(t.*t).*3.84E2+(t.*t.*t).*
      2.56E2-1.2E1

  dphi[9,:,2] =  (1./3).*s.*-2.08E2-(1./3).*t.*4.16E2+s.*t.*3.84E2-(1./3).*(s.*s.*s).*1.28E2-(1./3).*(t.*t.*t).*5.12E2-
      s.*(t.*t).*3.84E2-(s.*s).*t.*2.56E2+(s.*s).*9.6E1+(t.*t).*2.88E2+1.6E1

  dphi[10,:,2] =  (1./3).*s.*-2.08E2+s.*t.*1.92E2-(s.*s).*t.*2.56E2+(s.*s).*1.92E2-(s.*s.*s).*1.28E2-(1./3).*s.*(t.*t).*
      3.84E2

  dphi[11,:,2] =  s.*2.8E1-s.*t.*3.2E1+(s.*s).*t.*1.28E2-(s.*s).*1.44E2+(s.*s.*s).*1.28E2

  dphi[12,:,2] =  (1./3).*s.*-1.6E1-(1./3).*(s.*s.*s).*1.28E2+(s.*s).*3.2E1

  dphi[13,:,2] =  s.*9.6E1-s.*t.*4.48E2+s.*(t.*t).*3.84E2+(s.*s).*t.*5.12E2-(s.*s).*2.24E2+(s.*s.*s).*1.28E2

  dphi[14,:,2] =  s.*-3.2E1+s.*t.*6.4E1-(s.*s).*t.*2.56E2+(s.*s).*1.6E2-(s.*s.*s).*1.28E2

  dphi[15,:,2] =  s.*-3.2E1+s.*t.*3.2E2-s.*(t.*t).*3.84E2-(s.*s).*t.*2.56E2+(s.*s).*3.2E1

  return phi, dphi

end
